(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{106:function(e,t,a){"use strict";a.r(t);a(49),a(51),a(78),a(79);var n=a(0),r=a.n(n),i=a(45),s=a.n(i),l=a(73),o=a.n(l),c=a(110),u=a(111),h=a(65),d=a(12),p=a.n(d),m=a(17),b=a(5),f=a(6),v=a(9),E=a(7),y=a(8),k=a(64),j=a(33),O=a(63);function g(e){return function(t){function a(){var e;return Object(b.a)(this,a),(e=Object(v.a)(this,Object(E.a)(a).call(this))).state={loading:!0,redirect:!1},e}return Object(y.a)(a,t),Object(f.a)(a,[{key:"componentDidMount",value:function(){var e=this;fetch("/settings/checkDevice").then(function(t){if(200!==t.status)throw console.log("This is NOT a Desktop device"),new Error(t.error);console.log("This is a Desktop device"),e.setState({loading:!1})}).catch(function(t){console.error(t),console.log("redirecting"),e.setState({loading:!1,redirect:!0}),alert("Only desktop browsers can access the LetsFakeNews service")})}},{key:"render",value:function(){return this.state.loading?null:this.state.redirect?r.a.createElement(O.a,{to:"/"}):r.a.createElement(r.a.Fragment,null,r.a.createElement(e,this.props))}}]),a}(r.a.Component)}var w=function(e){function t(){return Object(b.a)(this,t),Object(v.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e;return e=this.props.hsize?this.props.hsize:"h4",r.a.createElement("div",null,r.a.createElement(e,null,this.props.title),r.a.createElement("p",null,this.props.desc))}}]),t}(r.a.Component),S=a(30),C=a(108),x=function(e){function t(){return Object(b.a)(this,t),Object(v.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){}},{key:"handleClick",value:function(){this.props.handleClick&&this.props.handleClick()}},{key:"render",value:function(){var e,t;return e=this.props.variant?this.props.variant:"secondary",t=this.props.buttonlabel?this.props.buttonlabel:"Submit",this.props.linkto?r.a.createElement("div",null,r.a.createElement("p",null,this.props.desc),r.a.createElement(S.a,{to:this.props.linkto},r.a.createElement(C.a,{variant:e,onClick:this.handleClick.bind(this)},t))):r.a.createElement("div",null,r.a.createElement("p",null,this.props.desc),r.a.createElement(C.a,{variant:e,onClick:this.handleClick.bind(this)},t))}}]),t}(r.a.Component),N=function(e){function t(){return Object(b.a)(this,t),Object(v.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("section",null,r.a.createElement(w,{title:"About...",desc:"Welcome to the LetsFakeNews 24-hour TV service... Al-Jazeera take your stories to display for the world to see."}),r.a.createElement("hr",null),r.a.createElement(x,{linkto:"/write",buttonlabel:"Write",desc:"Write fakenews on your device (Phone, Desktop etc.)"}),r.a.createElement("hr",null),r.a.createElement(x,{linkto:"/watch",buttonlabel:"Watch",desc:"Watch fakenews in fullscreen (Desktop only)"}),r.a.createElement("hr",null),r.a.createElement(x,{linkto:"/admin",buttonlabel:"Admin",desc:"Administer the fakenews (Password required)"}),r.a.createElement("hr",null)))}}]),t}(r.a.Component),P=function(e){function t(){return Object(b.a)(this,t),Object(v.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("section",null,r.a.createElement(w,{title:"Write...",desc:"Pretend you're a journalist with a deadline but no news to report. Why not trick the news-room into broadcasting a fake story? To ensure they accept your story use correct spelling, capitalisation etc."}),r.a.createElement("hr",null),r.a.createElement(x,{linkto:"/write/story",buttonlabel:"Start"}),r.a.createElement("hr",null)))}}]),t}(r.a.Component),R=a(25),_=a(10),T=a(112),A=function(e){function t(){return Object(b.a)(this,t),Object(v.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){}},{key:"handleChange",value:function(e){this.props.handleChange(e.target.value)}},{key:"handleSubmit",value:function(){this.props.handleSubmit&&this.props.handleSubmit()}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(T.a,{onSubmit:this.handleSubmit.bind(this)},r.a.createElement("div",null,r.a.createElement("textarea",{ref:function(e){null!=e&&e.focus()},className:"form-control form-responsive",required:"required",autoFocus:!0,rows:this.props.rows,maxLength:this.props.length,placeholder:"".concat(this.props.length," chars max..."),value:this.props.value,onChange:this.handleChange.bind(this)}),r.a.createElement(x,{linkto:this.props.linkto,buttonlabel:this.props.buttonlabel,handleClick:this.handleSubmit.bind(this)}))))}}]),t}(r.a.Component),F=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(v.a)(this,Object(E.a)(t).call(this,e))).apiCall=function(){var e=Object(m.a)(p.a.mark(function e(t){var a,n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return a=e.sent,e.next=5,a.json();case 5:if(n=e.sent,200===a.status){e.next=8;break}throw Error(n.message);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.apiPost=function(){var e=Object(m.a)(p.a.mark(function e(t,n){var r,i,s,l,o,c,u,h,d;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.hydrateSomeStateWithStorage(n),console.log(r),e.next=4,fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});case 4:return i=e.sent,e.next=7,i.text();case 7:for(s=e.sent,console.log(s),"Story contained no proper words"===s&&alert(s),l=!0,o=!1,c=void 0,e.prev=13,u=n[Symbol.iterator]();!(l=(h=u.next()).done);l=!0)d=h.value,a.setState(Object(R.a)({},d,""));e.next=21;break;case 17:e.prev=17,e.t0=e.catch(13),o=!0,c=e.t0;case 21:e.prev=21,e.prev=22,l||null==u.return||u.return();case 24:if(e.prev=24,!o){e.next=27;break}throw c;case 27:return e.finish(24);case 28:return e.finish(21);case 29:a.setState(function(){return{redirect:!0}});case 30:case"end":return e.stop()}},e,null,[[13,17,21,29],[22,,24,28]])}));return function(t,a){return e.apply(this,arguments)}}(),a.handleChange=a.handleChange.bind(Object(_.a)(Object(_.a)(a))),a.apiCall=a.apiCall.bind(Object(_.a)(Object(_.a)(a))),a.apiPost=a.apiPost.bind(Object(_.a)(Object(_.a)(a))),a.state={redirect:!1},a}return Object(y.a)(t,e),Object(f.a)(t,[{key:"saveStateToStorage",value:function(){for(var e in this.state)sessionStorage.setItem(e,JSON.stringify(this.state[e]))}},{key:"hydrateSomeStateWithStorage",value:function(e){var t={};for(var a in e)if(sessionStorage.hasOwnProperty(e[a])){var n=JSON.parse(sessionStorage.getItem(e[a]));t[e[a]]=n}return t}},{key:"hydrateStateWithStorage",value:function(){if(sessionStorage.hasOwnProperty(this.props.subject)){var e=sessionStorage.getItem(this.props.subject);try{e=JSON.parse(e),this.setState(Object(R.a)({},this.props.subject,e))}catch(t){this.setState(Object(R.a)({},this.props.subject,e))}}}},{key:"handleChange",value:function(e){this.setState(Object(R.a)({},this.props.subject,e))}},{key:"handleSubmit",value:function(){this.props.stateToSubmit&&(this.saveStateToStorage(),this.apiPost(this.props.apiEndPoint,this.props.stateToSubmit))}},{key:"componentWillMount",value:function(){window.addEventListener("beforeunload",this.saveStateToStorage.bind(this))}},{key:"componentDidMount",value:function(){this.hydrateStateWithStorage()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("beforeunload",this.saveStateToStorage.bind(this)),this.state.redirect?sessionStorage.clear():this.saveStateToStorage()}},{key:"loadStateSubject",value:function(e,t){var a;return Object.keys(e).forEach(function(n){n===t&&(a=e[n])}),a}},{key:"renderRedirect",value:function(){if(this.state.redirect)return r.a.createElement(O.a,{to:this.props.redirect})}},{key:"render",value:function(){var e=this.loadStateSubject(this.state,this.props.subject);return r.a.createElement("div",null,this.renderRedirect(),r.a.createElement("section",null,r.a.createElement(w,{hsize:"h4",title:this.props.title,desc:this.props.desc}),r.a.createElement("hr",null),r.a.createElement(A,{rows:this.props.rows,length:this.props.length,linkto:this.props.linkto,value:e,handleChange:this.handleChange.bind(this),handleSubmit:this.handleSubmit.bind(this)}),r.a.createElement("hr",null)))}}]),t}(r.a.Component),D=function(e){function t(){return Object(b.a)(this,t),Object(v.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("section",null,r.a.createElement(F,{title:"Write a story...",desc:"Make up a fake-news story",rows:"4",length:"280",subject:"story",linkto:"/write/title"})))}}]),t}(r.a.Component),M=function(e){function t(){return Object(b.a)(this,t),Object(v.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("section",null,r.a.createElement(F,{title:"Add a title...",desc:"Give a title to your story",rows:"1",length:"25",subject:"title",apiEndPoint:"/write/news",stateToSubmit:["story","title"],redirect:"/write/thankyou"})))}}]),t}(r.a.Component),W=function(e){function t(){return Object(b.a)(this,t),Object(v.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("section",null,r.a.createElement(F,{title:"Give your feedback...",desc:"Give us your response to writing & watching fake-news with us",rows:"4",length:"280",subject:"feedback",apiEndPoint:"/write/feedback",stateToSubmit:["feedback"],linkto:"/write/thankyou"}),r.a.createElement("hr",null)))}}]),t}(r.a.Component),G=function(e){function t(){return Object(b.a)(this,t),Object(v.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("section",null,r.a.createElement(w,{title:"Thank you...",desc:"We hope you enjoyed writing real fake-news"}),r.a.createElement("hr",null),r.a.createElement(x,{linkto:"/write/story",label:"restart",desc:"Write more fake news"}),r.a.createElement("hr",null),r.a.createElement(x,{linkto:"/write/feedback",label:"feedback",desc:"Leave your feedback for the LetsFakeNews team"}),r.a.createElement("hr",null)))}}]),t}(r.a.Component),q=function(e){function t(){return Object(b.a)(this,t),Object(v.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(k.a,null,r.a.createElement(j.a,{exact:!0,path:"/write",component:P}),r.a.createElement(j.a,{path:"/write/story",component:D}),r.a.createElement(j.a,{path:"/write/title",component:M}),r.a.createElement(j.a,{path:"/write/feedback",component:W}),r.a.createElement(j.a,{path:"/write/thankyou",component:G}),r.a.createElement(O.a,{to:"/write"})))}}]),t}(r.a.Component),L=function(e){function t(){return Object(b.a)(this,t),Object(v.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("section",null,r.a.createElement(w,{title:"Admin...",desc:"Use the following buttons to administer the databases"}),r.a.createElement("hr",null),r.a.createElement(x,{linkto:"/admin/stories",buttonlabel:"Stories",desc:"Administer stories as they are submitted"}),r.a.createElement("hr",null),r.a.createElement(x,{linkto:"/admin/feedback",buttonlabel:"Feedback",desc:"View feedback from users"}),r.a.createElement("hr",null)))}}]),t}(r.a.Component),J=(a(52),a(109)),I=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(v.a)(this,Object(E.a)(t).call(this,e))).apiGet=function(){var e=Object(m.a)(p.a.mark(function e(t){var a,n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return a=e.sent,e.next=5,a.json();case 5:if(n=e.sent,200===a.status){e.next=10;break}throw Error(n.message);case 10:return e.abrupt("return",n);case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.apiPost=function(){var e=Object(m.a)(p.a.mark(function e(t,a){var n,r;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});case 2:return n=e.sent,e.next=5,n.json();case 5:if(r=e.sent,200===n.status){e.next=8;break}throw Error(r.message);case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.eventSource=new EventSource("../settings/sse"),a.apiGet=a.apiGet.bind(Object(_.a)(Object(_.a)(a))),a.apiPost=a.apiPost.bind(Object(_.a)(Object(_.a)(a))),a.handleAutolive=a.handleAutolive.bind(Object(_.a)(Object(_.a)(a))),a.handleRefresh=a.handleRefresh.bind(Object(_.a)(Object(_.a)(a))),a.handleClear=a.handleClear.bind(Object(_.a)(Object(_.a)(a))),a.handleRemove=a.handleRemove.bind(Object(_.a)(Object(_.a)(a))),a.handleStorylive=a.handleStorylive.bind(Object(_.a)(Object(_.a)(a))),a.state={stories:[],autolive:!1},a}return Object(y.a)(t,e),Object(f.a)(t,[{key:"handleAutolive",value:function(e){var t=this;this.apiGet(this.props.apiAutolive).then(function(e){return t.setState({autolive:JSON.parse(e.autolive)})}).catch(function(e){return console.log(e)})}},{key:"handleRefresh",value:function(){document.activeElement.blur(),this.apiGet(this.props.apiRefresh).then(function(e){return console.log(e)}).catch(function(e){return console.log(e)})}},{key:"handleClear",value:function(){var e=this;document.activeElement.blur();var t={subject:this.props.title};this.apiPost(this.props.apiClear,t).then(function(t){return e.setState({stories:t.data})}).catch(function(e){return console.log(e)})}},{key:"handleRemove",value:function(e){var t=this;document.activeElement.blur(),this.apiPost(this.props.apiRemove,e).then(function(e){return t.setState({stories:e.stories})}).catch(function(e){return console.log(e)})}},{key:"handleStorylive",value:function(e){var t=this;this.apiPost(this.props.apiStorylive,e).then(function(e){return t.setState({stories:e.stories})}).catch(function(e){return console.log(e)})}},{key:"componentDidMount",value:function(){var e=this;this.eventSource.addEventListener("story",function(t){e.setState({stories:JSON.parse(t.data)})}),this.eventSource.onerror=function(e){console.log("---- ERROR: ",e)},this.apiGet(this.props.apiHello).then(function(t){e.setState({autolive:JSON.parse(t.autolive),stories:t.stories}),console.log(t)}).catch(function(e){return console.log(e)})}},{key:"componentWillUnmount",value:function(){this.eventSource.close()}},{key:"render",value:function(){var e,t=this,a={backgroundColor:"white"};return e=this.props.variant?this.props.variant:"danger",r.a.createElement("div",null,r.a.createElement(w,{desc:this.props.desc,title:this.props.title}),r.a.createElement("hr",null),r.a.createElement(J.a,{bordered:!0,style:a},r.a.createElement("thead",{className:"thead-dark"},r.a.createElement("tr",null,r.a.createElement("th",{style:{width:"95%"}},"Command"),r.a.createElement("th",{style:{width:"5%"}},"Action"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Set new stories to go live automatically"),r.a.createElement("td",{style:{textAlign:"center"}},r.a.createElement("input",{type:"checkbox",checked:this.state.autolive,onChange:this.handleAutolive.bind(this),className:"form-check-input show_tip autolive"}))),r.a.createElement("tr",null,r.a.createElement("td",null,"Refresh imagery for all stories"),r.a.createElement("td",null,r.a.createElement(C.a,{variant:e,onClick:this.handleRefresh.bind(this)}))),r.a.createElement("tr",null,r.a.createElement("td",null,"Clear all stories from database"),r.a.createElement("td",null,r.a.createElement(C.a,{variant:e,onClick:function(){window.confirm("Are you sure you wish to delete this item?")?t.handleClear():document.activeElement.blur()}}))))),r.a.createElement("hr",null),r.a.createElement(J.a,{ref:"table_stories",bordered:!0,hover:!0,style:a},r.a.createElement("thead",{className:"thead-dark"},r.a.createElement("tr",null,r.a.createElement("th",{style:{width:"5%"}},"#"),r.a.createElement("th",{style:{width:"20%"}},"Title"),r.a.createElement("th",{style:{width:"65%"}},"Story"),r.a.createElement("th",{style:{width:"6%"}},"Delete"),r.a.createElement("th",{style:{width:"4%"}},"Live"))),r.a.createElement("tbody",null,this.state.stories.length>0?this.state.stories.map(function(a,n){return r.a.createElement("tr",{key:n},r.a.createElement("td",{style:{display:"none"}},a._id),r.a.createElement("td",null,n+1),r.a.createElement("td",null,a.title),r.a.createElement("td",null,a.story),r.a.createElement("td",null,r.a.createElement(C.a,{variant:e,onClick:function(){return t.handleRemove(a)}})),r.a.createElement("td",{style:{textAlign:"center"}},r.a.createElement("input",{type:"checkbox",checked:!0===a.storylive,onChange:function(){return t.handleStorylive(a)},className:"form-check-input show_tip autolive"})))}):r.a.createElement("tr",null))),r.a.createElement("hr",null))}}]),t}(r.a.Component),z=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(v.a)(this,Object(E.a)(t).call(this,e))).apiGet=function(){var e=Object(m.a)(p.a.mark(function e(t){var a,n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return a=e.sent,e.next=5,a.json();case 5:if(n=e.sent,200===a.status){e.next=8;break}throw Error(n.message);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.apiPost=function(){var e=Object(m.a)(p.a.mark(function e(t,a){var n,r;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});case 2:return n=e.sent,e.next=5,n.json();case 5:if(r=e.sent,200===n.status){e.next=8;break}throw Error(r.message);case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.apiGet=a.apiGet.bind(Object(_.a)(Object(_.a)(a))),a.apiPost=a.apiPost.bind(Object(_.a)(Object(_.a)(a))),a.handleClear=a.handleClear.bind(Object(_.a)(Object(_.a)(a))),a.state={feedback:[]},a.eventSource=new EventSource("../settings/sse"),a}return Object(y.a)(t,e),Object(f.a)(t,[{key:"handleClear",value:function(){var e=this;document.activeElement.blur();var t={subject:this.props.title};this.apiPost(this.props.apiClear,t).then(function(t){return e.setState({feedback:t.data})}).catch(function(e){return console.log(e)})}},{key:"componentDidMount",value:function(){var e=this;this.eventSource.addEventListener("feedback",function(t){return e.setState({feedback:JSON.parse(t.data)})}),this.apiGet(this.props.apiHello).then(function(t){return e.setState({feedback:t.feedback})}).catch(function(e){return console.log(e)})}},{key:"componentWillUnmount",value:function(){this.eventSource.close()}},{key:"render",value:function(){var e,t=this,a={backgroundColor:"white"};return e=this.props.variant?this.props.variant:"danger",r.a.createElement("div",null,r.a.createElement(w,{desc:this.props.desc,title:this.props.title}),r.a.createElement("hr",null),r.a.createElement(J.a,{bordered:!0,style:a},r.a.createElement("thead",{className:"thead-dark"},r.a.createElement("tr",null,r.a.createElement("th",{style:{width:"95%"}},"Command"),r.a.createElement("th",{style:{width:"5%"}},"Action"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Clear all entries from database"),r.a.createElement("td",null,r.a.createElement(C.a,{variant:e,onClick:function(){window.confirm("Are you sure you wish to delete this item?")?t.handleClear():document.activeElement.blur()}}))))),r.a.createElement("hr",null),r.a.createElement(J.a,{bordered:!0,style:a},r.a.createElement("thead",{className:"thead-dark"},r.a.createElement("tr",null,r.a.createElement("th",{style:{width:"5%"}},"#"),r.a.createElement("th",{style:{width:"95%"}},"Feedback"))),r.a.createElement("tbody",null,this.state.feedback.length>0?this.state.feedback.map(function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,t+1),r.a.createElement("td",null,e.feedback))}):r.a.createElement("tr",null))),r.a.createElement("hr",null))}}]),t}(r.a.Component),U=function(e){function t(){var e;return Object(b.a)(this,t),(e=Object(v.a)(this,Object(E.a)(t).call(this))).apiCall=function(){var e=Object(m.a)(p.a.mark(function e(t){var a,n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return a=e.sent,e.next=5,a.json();case 5:if(n=e.sent,200===a.status){e.next=8;break}throw Error(n.message);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),e.apiCall=e.apiCall.bind(Object(_.a)(Object(_.a)(e))),e}return Object(y.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.a.createElement("div",{className:"layout"},r.a.createElement(k.a,null,r.a.createElement(j.a,{exact:!0,path:"/admin",component:L}),r.a.createElement(j.a,{path:"/admin/feedback",render:function(){return r.a.createElement(z,{title:"Feedback",desc:"Use this page to view user feedback in realtime",apiHello:"/admin/feedback",apiClear:"/admin/clear"})}}),r.a.createElement(j.a,{path:"/admin/stories",render:function(){return r.a.createElement(I,{title:"Stories",desc:"Use this page to moderate fakenews stories in realtime",apiHello:"/admin/stories",apiAutolive:"/admin/stories/autolive",apiRefresh:"/admin/stories/refresh",apiClear:"/admin/clear",apiRemove:"/admin/story/remove",apiStorylive:"/admin/story/storylive"})}}),r.a.createElement(O.a,{to:"/admin"})))}}]),t}(r.a.Component),H=function(e){function t(){return Object(b.a)(this,t),Object(v.a)(this,Object(E.a)(t).apply(this,arguments))}return Object(y.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("section",null,r.a.createElement(w,{title:"Watch...",desc:"Open this link on a desktop browser, set to fullscreen and enjoy the show!"}),r.a.createElement("hr",null),r.a.createElement(x,{linkto:"/watch/display",buttonlabel:"Watch"}),r.a.createElement("hr",null)))}}]),t}(r.a.Component),V=a(66),B=a.n(V),Y=function(e,t){return parseFloat((t-e).toFixed(1))},K=function(e,t,a){var n=e.urls,r=[];for(var i in n)r.push(n[i]);for(var s=Math.round(t/r.length),l=[],o=1;o<=r.length;o++)l.push(Math.round(a+s*o));return{urls:r,markers:l}},Q=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(v.a)(this,Object(E.a)(t).call(this,e))).apiGet=function(){var e=Object(m.a)(p.a.mark(function e(t){var a,n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return a=e.sent,e.next=5,a.json();case 5:if(n=e.sent,200===a.status){e.next=8;break}throw Error(n.message);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.apiGet=a.apiGet.bind(Object(_.a)(Object(_.a)(a))),a.handleFullscreen=a.handleFullscreen.bind(Object(_.a)(Object(_.a)(a))),a.onReady=a.onReady.bind(Object(_.a)(Object(_.a)(a))),a.onProgress=a.onProgress.bind(Object(_.a)(Object(_.a)(a))),a.onEnded=a.onEnded.bind(Object(_.a)(Object(_.a)(a))),a.state={mode:"",popupStart:6.2,popupEnd:11.3,imagesStart:17.6,imagesEnd:41.1,title:"",story:"",urls:[],markers:[],url_index:0,popup_title:{display:"none"},image_frame:{display:"none"},image:{display:"none"},scroller:{display:"none"},playing:!1,controls:!1,volume:1,progressInterval:500,url:"https://res.cloudinary.com/hi58qepi6/video/upload/v1548956607/aljazeera-desktop.mp4"},a}return Object(y.a)(t,e),Object(f.a)(t,[{key:"handleFullscreen",value:function(){document.activeElement.blur(),console.log("button fullscreen pressed"),!1===this.state.playing?this.setState({playing:!0}):this.setState({playing:!1});var e=this.container;e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()}},{key:"onReady",value:function(){var e=this;console.log("ready"),this.apiGet("/watch/request_new_story").then(function(t){return e.setState({title:t.data.title.toUpperCase(),story:t.data.story,urls:K(t.data,e.state.image_duration,e.state.imagesStart).urls,markers:K(t.data,e.state.image_duration,e.state.imagesStart).markers})}).then(function(){return console.log(e.state)}).catch(function(e){return console.log(e)})}},{key:"onProgress",value:function(e){var t=e.playedSeconds;t>=this.state.markers[this.state.url_index]&&this.setState({url_index:this.state.url_index+1}),t>=this.state.popupStart&&t<=this.state.popupEnd?this.setState({popup_title:{display:"block"}}):t>=this.state.imagesStart&&t<=this.state.imagesEnd?this.setState({popup_title:{display:"none"},image_frame:{display:"block"},image:{display:"block"},scroller:{display:"block"}}):this.setState({popup_title:{display:"none"},image_frame:{display:"none"},image:{display:"none"},scroller:{display:"none"}})}},{key:"onEnded",value:function(){this.player.seekTo(0)}},{key:"componentWillMount",value:function(){var e=this;console.log("componentWillMount"),this.apiGet("/settings/mode").then(function(t){e.setState({mode:t.dbSettings.node_mode})}).then(function(){"production"===e.state.mode?e.setState({playing:!1,controls:!1,volume:1}):e.setState({playing:!0,controls:!0,volume:0})}).catch(function(e){return console.log(e)}),this.setState({popup_duration:Y(this.state.popupStart,this.state.popupEnd),image_duration:Y(this.state.imagesStart,this.state.imagesEnd)})}},{key:"componentDidMount",value:function(){console.log("componentDidMount")}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(x,{desc:"Playback compatible with desktop browser only (not mobile)",buttonlabel:"PLAY",handleClick:this.handleFullscreen.bind(this.outerContainer)}),r.a.createElement("hr",null),r.a.createElement("div",{className:"media",id:"outerContainer",ref:function(t){e.outerContainer=t}},r.a.createElement("div",{id:"videoContainer",ref:function(t){e.container=t},className:"media-player"},r.a.createElement(B.a,{id:"videoPlayer",className:"react-player",volume:this.state.volume,width:"100%",height:"100%",ref:function(t){e.player=t},controls:this.state.controls,progressInterval:this.state.progressInterval,playing:this.state.playing,onReady:this.onReady.bind(this),onProgress:this.onProgress.bind(this),onEnded:this.onEnded.bind(this),url:this.state.url}),r.a.createElement("div",{id:"popup_title",style:this.state.popup_title},r.a.createElement("p",{id:"popup_title_text"},this.state.title)),r.a.createElement("div",{id:"image_frame",style:this.state.image_frame},r.a.createElement("img",{id:"image",alt:"",src:this.state.urls[this.state.url_index],style:this.state.image})),r.a.createElement("div",{id:"scroller",className:"scroll-left",style:this.state.scroller},r.a.createElement("p",{id:"scroller_text"},this.state.story)))))}}]),t}(r.a.Component),X=function(e){function t(){var e,a;Object(b.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(v.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(r)))).callApi=function(){var e=Object(m.a)(p.a.mark(function e(t){var a,n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return a=e.sent,e.next=5,a.json();case 5:if(n=e.sent,200===a.status){e.next=8;break}throw Error(n.message);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(y.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.a.createElement("div",{className:"layout"},r.a.createElement(k.a,null,r.a.createElement(j.a,{exact:!0,path:"/watch",component:H}),r.a.createElement(j.a,{path:"/watch/display",component:Q}),r.a.createElement(O.a,{to:"/watch"})))}}]),t}(r.a.Component),Z=a(113),$=a(114),ee=a(48),te=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(v.a)(this,Object(E.a)(t).call(this,e))).state={navExpanded:!1},a}return Object(y.a)(t,e),Object(f.a)(t,[{key:"getInitialState",value:function(){return{navExpanded:!1}}},{key:"setNavExpanded",value:function(e){this.setState({navExpanded:e})}},{key:"closeNav",value:function(){this.setState({navExpanded:!1})}},{key:"render",value:function(){var e=this.props.links.map(function(e,t){return r.a.createElement(ee.LinkContainer,{activeClassName:"active",key:t,to:"/".concat(e)},r.a.createElement(Z.a.Link,null,e))});return r.a.createElement("div",null,r.a.createElement($.a,{bg:"light",variant:"light",expand:"md",onToggle:this.setNavExpanded.bind(this),expanded:this.state.navExpanded},r.a.createElement(ee.LinkContainer,{to:this.props.title},r.a.createElement("a",{className:"navbar-brand",href:"/"},this.props.title)),r.a.createElement($.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),r.a.createElement($.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(Z.a,{className:"ml-auto",onSelect:this.closeNav.bind(this)},e))))}}]),t}(r.a.Component),ae=function(e){function t(e){var a;return Object(b.a)(this,t),(a=Object(v.a)(this,Object(E.a)(t).call(this,e))).state={username:"",password:"",redirect:!1},a}return Object(y.a)(t,e),Object(f.a)(t,[{key:"handleChange",value:function(e){var t=e.target,a=t.value,n=t.name;this.setState(Object(R.a)({},n,a))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),fetch("/settings/authenticate",{method:"POST",body:JSON.stringify(this.state),headers:{"Content-Type":"application/json"}}).then(function(e){if(200!==e.status)throw t.setState(function(){return{username:"",password:""}}),t.nameInput.focus(),new Error(e.error);t.setState(function(){return{redirect:!0}}),console.log("redirect",t.state.redirect)}).catch(function(e){console.error(e),alert("Error logging in please try again")})}},{key:"renderRedirect",value:function(){if(this.state.redirect)return r.a.createElement(O.a,{to:"/admin"})}},{key:"componentDidMount",value:function(){console.log("\n"),console.log(this.props),console.log(this.state),console.log("\n"),this.nameInput.focus()}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,this.renderRedirect(),r.a.createElement(w,{title:"Login...",desc:"Admin access requires authorisation..."}),r.a.createElement("hr",null),r.a.createElement(T.a,{onSubmit:this.handleSubmit.bind(this)},r.a.createElement("input",{type:"username",name:"username",ref:function(t){e.nameInput=t},placeholder:"Enter username",value:this.state.username,onChange:this.handleChange.bind(this),required:!0}),r.a.createElement("br",null),r.a.createElement("input",{type:"password",name:"password",placeholder:"Enter password",value:this.state.password,onChange:this.handleChange.bind(this),required:!0}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(C.a,{variant:"secondary",type:"submit"},"Submit")),r.a.createElement("hr",null))}}]),t}(r.a.Component),ne=function(e){function t(){var e,a;Object(b.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(v.a)(this,(e=Object(E.a)(t)).call.apply(e,[this].concat(r)))).callApi=function(){var e=Object(m.a)(p.a.mark(function e(t){var a,n;return p.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return a=e.sent,e.next=5,a.json();case 5:if(n=e.sent,200===a.status){e.next=8;break}throw Error(n.message);case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(y.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement(te,{title:"LetsFakeNews",links:["home","write","watch","admin"]}),r.a.createElement("br",null),r.a.createElement(k.a,null,r.a.createElement(j.a,{exact:!0,path:"/",component:N}),r.a.createElement(j.a,{path:"/write",component:q}),r.a.createElement(j.a,{path:"/admin",component:(e=U,function(t){function a(){var e;return Object(b.a)(this,a),(e=Object(v.a)(this,Object(E.a)(a).call(this))).state={loading:!0,redirect:!1},e}return Object(y.a)(a,t),Object(f.a)(a,[{key:"componentDidMount",value:function(){var e=this;fetch("/settings/checkToken").then(function(t){if(200!==t.status)throw new Error(t.error);e.setState({loading:!1})}).catch(function(t){console.error(t),console.log("redirecting"),e.setState({loading:!1,redirect:!0})})}},{key:"render",value:function(){return this.state.loading?null:this.state.redirect?r.a.createElement(O.a,{to:"/login"}):r.a.createElement(r.a.Fragment,null,r.a.createElement(e,this.props))}}]),a}(r.a.Component))}),r.a.createElement(j.a,{path:"/watch",component:g(X)}),r.a.createElement(j.a,{path:"/login",component:ae}),r.a.createElement(O.a,{to:"/"})));var e}}]),t}(r.a.Component);s.a.render(r.a.createElement(function(){return r.a.createElement(c.a,{as:"main"},r.a.createElement(u.a,null,r.a.createElement(h.a,{as:"aside",xs:1,sm:1,md:1,lg:1,xl:1}),r.a.createElement(h.a,{as:"article",xs:10,sm:10,md:10,lg:10,xl:10},r.a.createElement(o.a,null,r.a.createElement(ne,null))),r.a.createElement(h.a,{as:"aside",xs:1,sm:1,md:1,lg:1,xl:1})))},null),document.getElementById("react"))},74:function(e,t,a){e.exports=a(106)},79:function(e,t,a){}},[[74,1,2]]]);
//# sourceMappingURL=main.c8137164.chunk.js.map